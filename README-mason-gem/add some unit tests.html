<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title>add some unit tests</title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1404.34">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'; min-height: 16.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 11.0px Menlo; background-color: #d2f1ff}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 11.0px Menlo; background-color: #d2f1ff; min-height: 13.0px}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 11.0px Menlo; color: #bcbcbc; background-color: #d2f1ff}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 11.0px Menlo; color: #a1a111; background-color: #d2f1ff}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 11.0px Menlo; color: #b92e18; background-color: #d2f1ff}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 11.0px Menlo; color: #4a2bda; background-color: #d2f1ff}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 11.0px Menlo; color: #1baeba; background-color: #d2f1ff}
    p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 11.0px Menlo; color: #1daf14; background-color: #d2f1ff}
    p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: center; font: 12.0px Helvetica}
    span.s1 {font-variant-ligatures: no-common-ligatures}
    span.s2 {text-decoration: underline ; font-variant-ligatures: no-common-ligatures; color: #000000}
    span.s3 {font-variant-ligatures: no-common-ligatures; color: #1baeba}
    span.s4 {font-variant-ligatures: no-common-ligatures; color: #000000}
    span.s5 {font-variant-ligatures: no-common-ligatures; color: #4a2bda}
    span.s6 {font-variant-ligatures: no-common-ligatures; color: #a1a111}
    span.s7 {text-decoration: underline ; font-variant-ligatures: no-common-ligatures; color: #1daf14}
    span.s8 {font: 11.0px 'Apple Color Emoji'; font-variant-ligatures: no-common-ligatures; color: #a1a111}
    span.s9 {font: 11.0px 'Apple Color Emoji'; font-variant-ligatures: no-common-ligatures}
  </style>
</head>
<body>
<p class="p1"><b>add some unit tests</b></p>
<p class="p1">2016-01-23</p>
<p class="p2"><br></p>
<p class="p1">My next goal here is to add some actual useful code to this gem. So let's add some unit tests, as a first step.</p>
<p class="p2"><br></p>
<p class="p1">I think the normal way people do this is to add to the gem's root folder:</p>
<p class="p1">- a Rakefile</p>
<p class="p1">- a "tests" subfolder</p>
<p class="p1">- a set of 1 or more test case source files inside the "tests" subfolder</p>
<p class="p2"><br></p>
<p class="p1">So, I do all that:</p>
<p class="p2"><br></p>
<p class="p3"><span class="s1">[mason@tokyo mason-gem (master)]$ tree</span></p>
<p class="p3"><span class="s1">.</span></p>
<p class="p3"><span class="s1">├── README.md</span></p>
<p class="p3"><span class="s1">├── Rakefile</span></p>
<p class="p3"><span class="s1">├── lib</span></p>
<p class="p3"><span class="s1">│&nbsp;&nbsp; ├── mason</span></p>
<p class="p3"><span class="s1">│&nbsp;&nbsp; │&nbsp;&nbsp; └── command_wrapper.rb</span></p>
<p class="p3"><span class="s1">│&nbsp;&nbsp; └── mason.rb</span></p>
<p class="p3"><span class="s1">├── mason.gemspec</span></p>
<p class="p3"><span class="s1">├── test</span></p>
<p class="p3"><span class="s1">│&nbsp;&nbsp; └── test_mason.rb</span></p>
<p class="p2"><br></p>
<p class="p1">I just use the default Rakefile from the guide for now:</p>
<p class="p2"><br></p>
<p class="p3"><span class="s1">[mason@tokyo mason-gem (master)]$ pygmentize Rakefile<span class="Apple-converted-space">&nbsp;</span></span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p5"><span class="s1"># Mason 2016-01-23: I got this default started Rakefile from <a href="http://guides.rubygems.org/make-your-own-gem/#writing-tests"><span class="s2">http://guides.rubygems.org/make-your-own-gem/#writing-tests</span></a></span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s3">require</span><span class="s4"> </span><span class="s1">'rake/testtask'</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p7"><span class="s1">Rake</span><span class="s4">::</span><span class="s1">TestTask</span><span class="s4">.new </span><span class="s5">do</span><span class="s4"> |t|</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">&nbsp; </span>t.libs &lt;&lt; </span><span class="s6">'test'</span></p>
<p class="p8"><span class="s1">end</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s4">desc </span><span class="s1">"Run tests"</span></p>
<p class="p6"><span class="s4">task </span><span class="s1">:default</span><span class="s4"> =&gt; </span><span class="s1">:test</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">[mason@tokyo mason-gem (master)]$<span class="Apple-converted-space">&nbsp;</span></span></p>
<p class="p2"><br></p>
<p class="p1">And add a unit test file (one that will fail, to start with):</p>
<p class="p2"><br></p>
<p class="p3"><span class="s1">[mason@tokyo mason-gem (master)]$ pygmentize test/test_mason.rb<span class="Apple-converted-space">&nbsp;</span></span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s3">require</span><span class="s4"> </span><span class="s1">'minitest/autorun'</span></p>
<p class="p9"><span class="s1">require</span><span class="s4"> </span><span class="s6">'mason'</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p7"><span class="s5">class</span><span class="s4"> </span><span class="s7">MasonTest</span><span class="s4"> &lt; </span><span class="s1">Minitest</span><span class="s4">::</span><span class="s1">Unit</span><span class="s4">::</span><span class="s1">TestCase</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">&nbsp;&nbsp;</span></span></p>
<p class="p10"><span class="s4"><span class="Apple-converted-space">&nbsp; </span></span><span class="s5">def</span><span class="s4"> </span><span class="s1">test_sanity</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">&nbsp; &nbsp; </span>assert_equal </span><span class="s6">"</span><span class="s8">🐷</span><span class="s6">"</span><span class="s1">, </span><span class="s6">"your mom"</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">&nbsp; </span></span><span class="s1">end</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">&nbsp;&nbsp;</span></span></p>
<p class="p8"><span class="s1">end</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">[mason@tokyo mason-gem (master)]$<span class="Apple-converted-space">&nbsp;</span></span></p>
<p class="p2"><br></p>
<p class="p1">...et voilà!</p>
<p class="p2"><br></p>
<p class="p3"><span class="s1">[mason@tokyo mason-gem (master)]$ rake test</span></p>
<p class="p3"><span class="s1">Run options: --seed 37958</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p3"><span class="s1"># Running tests:</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">F</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">Finished tests in 0.006439s, 155.3036 tests/s, 155.3036 assertions/s.</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">&nbsp; </span>1) Failure:</span></p>
<p class="p3"><span class="s1">MasonTest#test_sanity [/Users/mason/Code/mason-gem/test/test_mason.rb:7]:</span></p>
<p class="p3"><span class="s1">Expected: "</span><span class="s9">🐷</span><span class="s1">"</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">&nbsp; </span>Actual: "your mom"</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">1 tests, 1 assertions, 1 failures, 0 errors, 0 skips</span></p>
<p class="p3"><span class="s1">rake aborted!</span></p>
<p class="p3"><span class="s1">Command failed with status (1): [ruby -I"lib:test" -I"/usr/local/var/rbenv/versions/2.1.5/lib/ruby/2.1.0" "/usr/local/var/rbenv/versions/2.1.5/lib/ruby/2.1.0/rake/rake_test_loader.rb" "test/test*.rb" ]</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">Tasks: TOP =&gt; test</span></p>
<p class="p3"><span class="s1">(See full trace by running task with --trace)</span></p>
<p class="p3"><span class="s1">[mason@tokyo mason-gem (master)]$<span class="Apple-converted-space">&nbsp;</span></span></p>
<p class="p2"><br></p>
<p class="p1">Cool! In this case, the "F" is for "Fuck yeah, we are almost to the point where we can add the first useful code to this gem."</p>
<p class="p2"><br></p>
<p class="p11"><img src="add%20some%20unit%20tests.Pasted%20Graphic.png" width="1200" height="900" alt="Pasted Graphic.tiff"></p>
</body>
</html>
